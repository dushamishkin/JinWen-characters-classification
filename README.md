# Предложение о курсовой работе
# Тема: **классификация древнекитайских иероглифов на бронзовых сосудах**

# Определение цзиньвэнь 金文
Цзиньвэнь 金文 jīn wén – надписи, выполненные на древних китайских бронзовых изделиях, датируются эпохами Шан (1554-1046 гг. до н. э.) и Чжоу (1045-221 гг. до н. э.)

![JinWen_example](https://upload.wikimedia.org/wikipedia/commons/2/27/LishuHuashanmiao.jpg "Пример цзиньвэнь")

Подавляющее число цзиньвэней являются прямыми предшественниками современных китайских иероглифов. Ниже продемонстрирована эволюция иероглифа 足 от цзиньвэнь до современного образа

![jinwen-to-modern](https://img01.yzcdn.cn/upload_files/2017/02/20/FtrwinMVN3lgGmxdgsHw1vj3VwjK.jpg!730x0.jpg "Эволюция иероглифа от цзиньвэнь до современного образа")

# Цели проекта
**Основная.** Обучить модель, классифицирующую иероглифы цзиньвэнь. Задача многоклассовой классификации на 3069 классов. На вход подается изображение 28х28, содержащее иероглиф, модель предсказывает номер класса в соответствии с сайтом https://xiaoxue.iis.sinica.edu.tw/jinwen (о нем будет рассказано ниже)

**Возможные дополнительные задачи.** При достижении хорошего качества у классификатора могут быть поставлены следующие цели:
- **Имплементация детектирования иероглифов**. На вход подается не 1 иероглиф, а изображение непосредственно сосуда/скана надписи, модель предсказывает области иероглифов и их классы. Пример, как это сделать [тут](https://pyimagesearch.com/2020/06/22/turning-any-cnn-image-classifier-into-an-object-detector-with-keras-tensorflow-and-opencv/)
- **Создание веб-сервиса**, в котором пользователь рисует иероглиф на холсте, а модель предсказывает класс. Пример [тут](https://towardsdatascience.com/develop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0)

# Методы
- Составление датасета осуществляется путем парсинга базы данных Тайваньского Национального Университета: https://xiaoxue.iis.sinica.edu.tw/jinwen (*есть код, надо заново спарсить, чтобы получить актуальные данные)
- Препоцессинг изображений включает в себя
    - Ручное удаление лишних элементов-изображений, загруженных во время парсинга (избавиться от них автоматически, к сожалению, нельзя)
    - Конвертация RGBA to RGB (*есть код)
    - Удаление шума, возникшего при сканировании иероглифов (*есть код), пример ниже: 
    
    ![Bad](https://xiaoxue.iis.sinica.edu.tw/ImageText2/ShowImage.ashx?text=%ee%a3%90&font=%e4%b8%ad%e7%a0%94%e9%99%a2%e9%87%91%e6%96%87%e9%87%8d%e6%96%87%e5%85%ab&size=36&style=regular&color=%23000000 "Bad image")
    ![Good](https://xiaoxue.iis.sinica.edu.tw/ImageText2/ShowImage.ashx?text=%ee%b6%ba&font=%e4%b8%ad%e7%a0%94%e9%99%a2%e9%87%91%e6%96%87%e9%87%8d%e6%96%87%e4%b8%89&size=36&style=regular&color=%23000000 "Good image")
    - Аугментацию (*есть код)
- Модель
    - Предобученные модели ResNet34 / vgg16
    - MobileNetV3, если подразумевается создание веб-сервиса
    - Архитектура, имеющая высокий скор на MNIST датасете. Ансамбль простых сверточных сетей - [статья](https://arxiv.org/pdf/2008.10400v2.pdf)

## Возможные проблемы
- Сложность поиска достаточного объема научной литературы
- Один класс может содержать сильно непохожие друг на друга образы, например:

![One](https://xiaoxue.iis.sinica.edu.tw/ImageText2/ShowImage.ashx?text=%ee%b6%ba&font=%e4%b8%ad%e7%a0%94%e9%99%a2%e9%87%91%e6%96%87%e9%87%8d%e6%96%87%e4%b8%89&size=36&style=regular&color=%23000000 "First type")
![Two](https://xiaoxue.iis.sinica.edu.tw/ImageText2/ShowImage.ashx?text=%ee%b7%84&font=%e4%b8%ad%e7%a0%94%e9%99%a2%e9%87%91%e6%96%87%e9%87%8d%e6%96%87%e4%b8%89&size=36&style=regular&color=%23000000 "Second type")
- Высокий дисбаланс классов: >20 в одном против <2 в другом

# В ближайшее время
1. Заново соберу актуальный датасет
2. Обучу бейзлайн в fastai. Далее буду использовать только torch
